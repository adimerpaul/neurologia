import{c as P,L as V,M as b,O as E,P as I,R as K,S as N,T as W,U as Y,V as U,W as X,A as C,X as Z,h as p,Y as J,Z as $,$ as ee,a0 as te,a1 as oe,a2 as le,_ as ae,o as f,f as w,w as d,y as ie,j as a,q as D,g as s,B as m,p as A,C as L,D as se,E as ne,a3 as re,t as h,I as c,a4 as de,a5 as ue,a6 as Q,v as ce,a7 as me,a8 as q,a9 as S,aa as g,z as ge}from"./index.f1bedefb.js";var pe=P({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const i=V(()=>{const n=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(o=>e[o]===!0).map(o=>`q-btn-group--${o}`).join(" ");return`q-btn-group row no-wrap${n.length!==0?" "+n:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>b("div",{class:i.value},E(t.default))}});const fe=Object.keys(I),he=e=>fe.reduce((t,i)=>{const n=e[i];return n!==void 0&&(t[i]=n),t},{});var be=P({name:"QBtnDropdown",props:{...I,...K,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:i}){const{proxy:n}=J(),o=N(e.modelValue),u=N(null),l=W(),y=V(()=>{const r={"aria-expanded":o.value===!0?"true":"false","aria-haspopup":"true","aria-controls":l,"aria-label":e.toggleAriaLabel||n.$q.lang.label[o.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(r["aria-disabled"]="true"),r}),v=V(()=>"q-btn-dropdown__arrow"+(o.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),x=V(()=>Y(e)),R=V(()=>he(e));U(()=>e.modelValue,r=>{u.value!==null&&u.value[r?"show":"hide"]()}),U(()=>e.split,B);function M(r){o.value=!0,i("beforeShow",r)}function O(r){i("show",r),i("update:modelValue",!0)}function G(r){o.value=!1,i("beforeHide",r)}function H(r){i("hide",r),i("update:modelValue",!1)}function F(r){i("click",r)}function j(r){$(r),B(),i("click",r)}function z(r){u.value!==null&&u.value.toggle(r)}function _(r){u.value!==null&&u.value.show(r)}function B(r){u.value!==null&&u.value.hide(r)}return Object.assign(n,{show:_,hide:B,toggle:z}),X(()=>{e.modelValue===!0&&_()}),()=>{const r=[b(C,{class:v.value,name:e.dropdownIcon||n.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&r.push(b(Z,{ref:u,id:l,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:M,onShow:O,onBeforeHide:G,onHide:H},t.default)),e.split===!1?b(p,{class:"q-btn-dropdown q-btn-dropdown--simple",...R.value,...y.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:F},{default:()=>E(t.label,[]).concat(r),loading:t.loading}):b(pe,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...x.value,glossy:e.glossy,stretch:e.stretch},()=>[b(p,{class:"q-btn-dropdown--current",...R.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:j},{default:t.label,loading:t.loading}),b(p,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...y.value,...x.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>r)])}}});function T(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}var k=ee({name:"close-popup",beforeMount(e,{value:t}){const i={depth:T(t),handler(n){i.depth!==0&&setTimeout(()=>{const o=te(e);o!==void 0&&oe(o,n,i.depth)})},handlerKey(n){le(n,13)===!0&&i.handler(n)}};e.__qclosepopup=i,e.addEventListener("click",i.handler),e.addEventListener("keyup",i.handlerKey)},updated(e,{value:t,oldValue:i}){t!==i&&(e.__qclosepopup.depth=T(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});const ve={name:"RegisterPage",data(){return{loading:!1,registros:[],registrosAll:[],registro:{},registroDialog:!1,search:""}},mounted(){this.registroGet()},methods:{filterRegistros(){this.search?this.registros=this.registrosAll.filter(e=>e.firstSurname.toLowerCase().includes(this.search.toLowerCase())||e.secondSurname.toLowerCase().includes(this.search.toLowerCase())||e.firstName.toLowerCase().includes(this.search.toLowerCase())||e.secondName.toLowerCase().includes(this.search.toLowerCase())||e.ci.includes(this.search)||e.phone.includes(this.search)||e.email.toLowerCase().includes(this.search.toLowerCase())):this.registros=this.registrosAll},clickRegistrar(){this.registro={},this.registroDialog=!0},submit(){this.registro.id?this.updateRegistro():this.crearRegistro()},updateRegistro(){this.loading=!0;const e=new FormData;e.append("id",this.registro.id),e.append("firstSurname",this.registro.firstSurname),e.append("secondSurname",this.registro.secondSurname),e.append("firstName",this.registro.firstName),e.append("secondName",this.registro.secondName),e.append("ci",this.registro.ci),e.append("phone",this.registro.phone),e.append("email",this.registro.email),e.append("profession",this.registro.profession),e.append("departamento",this.registro.departamento),e.append("provincia",this.registro.provincia),e.append("direccion",this.registro.direccion),e.append("cursoTaller",this.registro.cursoTaller),this.registro.file&&e.append("file",this.registro.file),this.registro.file2&&e.append("file2",this.registro.file2),this.$axios.post(`registro/${this.registro.id}`,e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{this.$q.notify({type:"positive",message:"Registro actualizado",position:"top"}),this.registroGet()}).catch(t=>{var n,o;const i=((o=(n=t.response)==null?void 0:n.data)==null?void 0:o.message)||"Error al actualizar registro";this.$q.notify({type:"red",message:i,position:"top"})}).finally(()=>{this.registroDialog=!1,this.loading=!1})},crearRegistro(){this.loading=!0;const e=new FormData;e.append("firstName",this.registro.firstName),e.append("firstSurname",this.registro.firstSurname),e.append("secondSurname",this.registro.secondSurname),e.append("ci",this.registro.ci),e.append("phone",this.registro.phone),e.append("email",this.registro.email),e.append("profession",this.registro.profession),e.append("departamento",this.registro.departamento),e.append("provincia",this.registro.provincia),e.append("direccion",this.registro.direccion),e.append("cursoTaller",this.registro.cursoTaller),e.append("file",this.registro.file),e.append("file2",this.registro.file2),this.$axios.post("registro",e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{this.$q.notify({type:"positive",message:t.data.message,position:"top"}),this.registroGet()}).catch(t=>{var n,o;const i=((o=(n=t.response)==null?void 0:n.data)==null?void 0:o.message)||"Error al crear registro";this.$q.notify({type:"red",message:i,position:"top"})}).finally(()=>{this.registroDialog=!1,this.loading=!1})},eliminarRegistro(e){this.$q.dialog({title:"Eliminar Registro",message:`\xBFEst\xE1 seguro de eliminar el registro de ${e.firstName} ${e.firstSurname}?`,cancel:!0,persistent:!0}).onOk(()=>{this.loading=!0,this.$axios.delete(`registro/${e.id}`).then(t=>{this.$q.notify({type:"positive",message:t.data.message,position:"top"}),this.registroGet()}).catch(t=>{var n,o;const i=((o=(n=t.response)==null?void 0:n.data)==null?void 0:o.message)||"Error al eliminar registro";this.$q.notify({type:"red",message:i,position:"top"})}).finally(()=>{this.loading=!1})})},editarRegistro(e){this.registro={...e},this.registroDialog=!0},mandarRegistro(e){const t=e.phone.replace(/\D/g,""),i=`Hola ${e.firstName}, te damos la bienvenida. Tu cuenta ha sido creada:

Usuario: ${e.ci}
Contrase\xF1a: ${e.ci}`,n=`https://wa.me/591${t}?text=${encodeURIComponent(i)}`;window.open(n,"_blank")},crearUsuario(e){this.$q.loading.show(),this.$axios.post("/registro/crear-usuario",{id:e.id}).then(t=>{this.$q.notify({type:"positive",message:t.data.message,position:"top"})}).catch(t=>{var n,o;const i=((o=(n=t.response)==null?void 0:n.data)==null?void 0:o.message)||"Error al crear usuario";this.$q.notify({type:"warning",message:i,position:"top"})}).finally(()=>{this.$q.loading.hide()})},verFoto(e){this.$q.dialog({title:"Ver foto",message:`<img src="${this.$url}../storage/${e}" style="max-width: 100%; max-height: 100%;" />`,persistent:!0,html:!0})},registroGet(){this.loading=!0,this.$axios.get("/registro").then(e=>{this.registros=e.data,this.registrosAll=e.data,this.loading=!1}).catch(e=>{console.error("Error fetching registros:",e),this.loading=!1})}}},we={class:"row"},Ve={class:"col-12 col-md-8"},Ce={class:"col-12 col-md-2"},ye={class:"col-12 col-md-2 text-right"},qe=s("thead",null,[s("tr",null,[s("th",null,"Opciones"),s("th",null,"Nombre Completo"),s("th",null,"CI"),s("th",null,"Tel\xE9fono"),s("th",null,"Ver foto"),s("th",null,"Email"),s("th",null,"Profesi\xF3n"),s("th",null,"Departamento"),s("th",null,"Provincia"),s("th",null,"Direcci\xF3n"),s("th",null,"Curso/Taller"),s("th",null,"Fecha")])],-1),Se={class:"q-mt-md"};function ke(e,t,i,n,o,u){return f(),w(ie,{class:"bg-grey-3 q-pa-md"},{default:d(()=>[a(A,{flat:"",bordered:""},{default:d(()=>[a(D,{class:"q-pa-xs"},{default:d(()=>[s("div",we,[s("div",Ve,[a(m,{modelValue:o.search,"onUpdate:modelValue":[t[0]||(t[0]=l=>o.search=l),u.filterRegistros],dense:"",outlined:"",label:"Buscar",class:"q-mb-md"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Ce,[a(p,{onClick:u.registroGet,color:"primary",label:"Actualizar Registros",class:"q-mb-md","no-caps":"",loading:o.loading,icon:"refresh"},null,8,["onClick","loading"])]),s("div",ye,[a(p,{onClick:u.clickRegistrar,color:"green",label:"Crear Registro",class:"q-mb-md","no-caps":"",icon:"add_circle"},null,8,["onClick"])])])]),_:1})]),_:1}),a(re,{dense:"","wrap-cells":"",flat:"",bordered:""},{default:d(()=>[qe,s("tbody",null,[(f(!0),L(ne,null,se(o.registros,(l,y)=>(f(),L("tr",{key:y},[s("td",null,[a(be,{color:"primary","text-color":"white",dense:"",label:"Opciones","no-caps":"",size:"xs",loading:o.loading},{default:d(()=>[a(me,null,{default:d(()=>[q((f(),w(S,{clickable:"",onClick:v=>u.crearUsuario(l)},{default:d(()=>[a(g,{avatar:""},{default:d(()=>[a(C,{name:"person_add"})]),_:1}),a(g,null,{default:d(()=>[h("Crear usuario")]),_:1})]),_:2},1032,["onClick"])),[[k]]),q((f(),w(S,{clickable:"",onClick:v=>u.mandarRegistro(l)},{default:d(()=>[a(g,{avatar:""},{default:d(()=>[a(C,{name:"fa-brands fa-whatsapp"})]),_:1}),a(g,null,{default:d(()=>[h("Mandar por WhatsApp")]),_:1})]),_:2},1032,["onClick"])),[[k]]),q((f(),w(S,{clickable:"",onClick:v=>u.editarRegistro(l)},{default:d(()=>[a(g,{avatar:""},{default:d(()=>[a(C,{name:"visibility"})]),_:1}),a(g,null,{default:d(()=>[h("Ver")]),_:1})]),_:2},1032,["onClick"])),[[k]]),q((f(),w(S,{clickable:"",onClick:v=>u.eliminarRegistro(l)},{default:d(()=>[a(g,{avatar:""},{default:d(()=>[a(C,{name:"delete"})]),_:1}),a(g,null,{default:d(()=>[h("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1032,["loading"])]),s("td",null,c(l.firstSurname)+" "+c(l.secondSurname)+" "+c(l.firstName)+" "+c(l.secondName),1),s("td",null,c(l.ci),1),s("td",null,c(l.phone),1),s("td",null,[a(ge,{src:`${e.$url}../storage/${l.file}`,style:{"max-width":"100px","max-height":"100px"},onClick:v=>u.verFoto(l.file)},null,8,["src","onClick"])]),s("td",null,c(l.email),1),s("td",null,c(l.profession),1),s("td",null,c(l.departamento),1),s("td",null,c(l.provincia),1),s("td",null,c(l.direccion),1),s("td",null,c(l.cursoTaller),1),s("td",null,c(e.$filters.datedmYHi(l.created_at)),1)]))),128))])]),_:1}),a(ce,{modelValue:o.registroDialog,"onUpdate:modelValue":t[17]||(t[17]=l=>o.registroDialog=l),persistent:""},{default:d(()=>[a(A,null,{default:d(()=>[a(D,{class:"q-pb-none"},{default:d(()=>[h(c(o.registro.id?"Editar Registro":"Crear Registro")+" ",1),a(p,{flat:"",icon:"close",onClick:t[1]||(t[1]=l=>o.registroDialog=!1),class:"absolute-top-right q-mt-xs q-mr-xs"})]),_:1}),a(D,null,{default:d(()=>[a(de,{onSubmit:ue(u.submit,["prevent"])},{default:d(()=>[a(m,{modelValue:o.registro.firstSurname,"onUpdate:modelValue":t[2]||(t[2]=l=>o.registro.firstSurname=l),dense:"",outlined:"",label:"Apellido Paterno"},null,8,["modelValue"]),a(m,{modelValue:o.registro.secondSurname,"onUpdate:modelValue":t[3]||(t[3]=l=>o.registro.secondSurname=l),dense:"",outlined:"",label:"Apellido Materno"},null,8,["modelValue"]),a(m,{modelValue:o.registro.firstName,"onUpdate:modelValue":t[4]||(t[4]=l=>o.registro.firstName=l),dense:"",outlined:"",label:"Nombre"},null,8,["modelValue"]),a(m,{modelValue:o.registro.secondName,"onUpdate:modelValue":t[5]||(t[5]=l=>o.registro.secondName=l),dense:"",outlined:"",label:"Segundo Nombre"},null,8,["modelValue"]),a(m,{modelValue:o.registro.ci,"onUpdate:modelValue":t[6]||(t[6]=l=>o.registro.ci=l),dense:"",outlined:"",label:"CI"},null,8,["modelValue"]),a(m,{modelValue:o.registro.phone,"onUpdate:modelValue":t[7]||(t[7]=l=>o.registro.phone=l),dense:"",outlined:"",label:"Tel\xE9fono"},null,8,["modelValue"]),a(m,{modelValue:o.registro.email,"onUpdate:modelValue":t[8]||(t[8]=l=>o.registro.email=l),dense:"",outlined:"",label:"Email",type:"email"},null,8,["modelValue"]),a(m,{modelValue:o.registro.profession,"onUpdate:modelValue":t[9]||(t[9]=l=>o.registro.profession=l),dense:"",outlined:"",label:"Profesi\xF3n"},null,8,["modelValue"]),a(m,{modelValue:o.registro.departamento,"onUpdate:modelValue":t[10]||(t[10]=l=>o.registro.departamento=l),dense:"",outlined:"",label:"Departamento"},null,8,["modelValue"]),a(m,{modelValue:o.registro.provincia,"onUpdate:modelValue":t[11]||(t[11]=l=>o.registro.provincia=l),dense:"",outlined:"",label:"Provincia"},null,8,["modelValue"]),a(m,{modelValue:o.registro.direccion,"onUpdate:modelValue":t[12]||(t[12]=l=>o.registro.direccion=l),dense:"",outlined:"",label:"Direcci\xF3n"},null,8,["modelValue"]),a(m,{modelValue:o.registro.cursoTaller,"onUpdate:modelValue":t[13]||(t[13]=l=>o.registro.cursoTaller=l),dense:"",outlined:"",label:"Curso/Taller"},null,8,["modelValue"]),a(Q,{modelValue:o.registro.file,"onUpdate:modelValue":t[14]||(t[14]=l=>o.registro.file=l),dense:"",outlined:"",label:"Comprobante de pago",type:"file"},null,8,["modelValue"]),a(Q,{modelValue:o.registro.file2,"onUpdate:modelValue":t[15]||(t[15]=l=>o.registro.file2=l),dense:"",outlined:"",label:"Comprobante de pago 2",type:"file"},null,8,["modelValue"]),s("div",Se,[a(p,{type:"submit",color:"primary",loading:o.loading},{default:d(()=>[h("Guardar")]),_:1},8,["loading"]),a(p,{flat:"",onClick:t[16]||(t[16]=l=>o.registroDialog=!1),loading:o.loading},{default:d(()=>[h("Cancelar")]),_:1},8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var De=ae(ve,[["render",ke]]);export{De as default};
